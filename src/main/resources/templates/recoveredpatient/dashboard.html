<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" th:replace="recoveredpatient_base :: parent(~{::section}, 'Dashboard', ~{::script})">
<head>
    <title th:text="${loggedInUser?.name} + ' | Dashboard'">Dashboard</title>
</head>
<body>
<section>
  <div id="home" class="w-full">
    <div class="container mx-auto px-4 pt-12 sm:pt-4">
      <div
        class="header text-center bg-white dark:bg-gray-800 p-6 rounded-lg border border-gray-200 dark:border-gray-700 mb-6">
        <h2 class="text-2xl sm:text-3xl font-bold text-gray-800 dark:text-gray-100 mb-2"
          th:text="'Welcome back, ' + ${loggedInUser?.name} + '!'"></h2>
        <p class="text-lg text-gray-600 dark:text-gray-300" th:text="'Here\'s your health overview'"></p>
      </div>
      <!-- here will be upar ka maal  -->

      <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4 mb-4">
        <div class="p-6 bg-white border border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700">
          <div class="flex items-center mb-4">
            <svg xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
              class="lucide lucide-activity w-6 h-6 text-blue-600 dark:text-blue-400 mr-2">
              <path d="M22 12h-4l-3 9L9 3l-3 9H2"></path>
            </svg>
            <h3 class="text-lg font-semibold text-gray-900 dark:text-white">
              Health Score
            </h3>
          </div>
          <div class="flex items-baseline mb-2">
            <p class="text-3xl font-bold text-gray-900 dark:text-white">76</p>
            <p class="ml-1 text-xl font-medium text-gray-500 dark:text-gray-400">
              /100
            </p>
          </div>
          <div class="flex items-center text-sm text-gray-500 dark:text-gray-400">
            <svg class="w-4 h-4 mr-1 text-green-500 dark:text-green-400" fill="none" stroke="currentColor"
              viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18">
              </path>
            </svg>
            <span>~ 5% vs last week</span>
          </div>
        </div>
        <div class="p-6 bg-white border border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700">
          <div class="flex items-center mb-4">
            <svg xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
              class="lucide lucide-users text-blue-600">
              <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
              <circle cx="9" cy="7" r="4"></circle>
              <path d="M22 21v-2a4 4 0 0 0-3-3.87"></path>
              <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
            </svg>
            <h3 class="text-lg font-semibold text-gray-900 dark:text-white">
              Active Connections
            </h3>
          </div>
          <div class="flex items-baseline mb-2">
            <p class="text-3xl font-bold text-gray-900 dark:text-white">24</p>
          </div>
          <div class="flex items-center text-sm text-gray-500 dark:text-gray-400">
            <svg class="w-4 h-4 mr-1 text-green-500 dark:text-green-400" fill="none" stroke="currentColor"
              viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18">
              </path>
            </svg>
            <span>~ 2% vs last week</span>
          </div>
        </div>
        <div class="p-6 bg-white border border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700">
          <div class="flex items-center mb-4">
            <svg xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
              class="lucide lucide-calendar-clock text-purple-600">
              <path d="M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5"></path>
              <path d="M16 2v4"></path>
              <path d="M8 2v4"></path>
              <path d="M3 10h5"></path>
              <path d="M17.5 17.5 16 16.3V14"></path>
              <circle cx="16" cy="16" r="6"></circle>
            </svg>
            <h3 class="text-lg font-semibold text-gray-900 dark:text-white">
              Upcoming Appointments
            </h3>
          </div>
          <div class="flex items-baseline mb-2">
            <p class="text-3xl font-bold text-gray-900 dark:text-white">3</p>
          </div>
          <div class="flex items-center text-sm text-gray-500 dark:text-gray-400">
            <svg class="w-4 h-4 mr-1 text-green-500 dark:text-green-400" fill="none" stroke="currentColor"
              viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18">
              </path>
            </svg>
            <span>~ 5% vs last week</span>
          </div>
        </div>
        <div class="p-6 bg-white border border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700">
          <div class="flex items-center mb-4">
            <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
              class="lucide lucide-trending-up text-green-600">
              <polyline points="22 7 13.5 15.5 8.5 10.5 2 17"></polyline>
              <polyline points="16 7 22 7 22 13"></polyline>
            </svg>
            <h3 class="text-lg font-semibold text-gray-900 dark:text-white">
              Goal Progress
            </h3>
          </div>
          <div class="flex items-baseline mb-2">
            <p class="text-3xl font-bold text-gray-900 dark:text-white">
              70%
            </p>
          </div>
          <div class="flex items-center text-sm text-gray-500 dark:text-gray-400">
            <svg class="w-4 h-4 mr-1 text-green-500 dark:text-green-400" fill="none" stroke="currentColor"
              viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18">
              </path>
            </svg>
            <span>~ 15% vs last week</span>
          </div>
        </div>
      </div>
      <div class="bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4 mb-4 shadow-sm">
        <h3 class="text-lg font-medium mb-2">Health Metrics</h3>
        <p class="text-sm mb-4">Today's progress towards your goals</p>
        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-6">
          <!-- Nutrition tracking starts here -->
          <div class="text-center">
            <div class="relative w-24 h-24 mx-auto" id="nutrition-score-circle">
              <svg class="w-full h-full transform -rotate-90">
                <circle cx="50%" cy="50%" r="45%" fill="none" stroke-width="8" stroke="#e0e0e0"></circle>
                <circle id="nutrition-score-progress" cx="50%" cy="50%" r="45%" fill="none" stroke-width="8"
                  stroke="#1976d2" stroke-dasharray="283" stroke-dashoffset="283"
                  style="transition: stroke-dashoffset 0.3s">
                </circle>
              </svg>
              <div class="absolute inset-0 flex flex-col items-center justify-center">
                <span id="nutrition-score-value" class="text-2xl font-bold text-gray-800 dark:text-white">0</span>
                <span class="text-xs text-gray-500 mt-1">Nutrition Score</span>
              </div>
            </div>
            <p class="text-sm mt-2 text-gray-600 dark:text-gray-300">
              Nutrition Score (0-10)
            </p>

            <!-- Modal toggle -->
            <div class="flex justify-center">
              <button id="resetFoodButton" disabled
                class="border border-gray-400 dark:border-gray-300 rounded-lg px-5 mt-1 py-1 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100">
                Add food
              </button>
            </div>
            <div class="flex justify-center">
              <button id="resetFoodButton" disabled
                class="border border-gray-400 dark:border-gray-300 rounded-lg px-5 mt-1 py-1 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100">
                Reset
              </button>
            </div>

            <!-- Main modal -->
            <div id="timeline-modal" tabindex="-1" aria-hidden="true"
              class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full">
              <div class="relative p-4 w-full max-w-4xl max-h-[80vh]">
                <!-- Modal content -->
                <div class="relative bg-white rounded-lg shadow-sm dark:bg-gray-700">
                  <!-- Modal header -->
                  <div
                    class="flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:border-gray-600 border-gray-200">
                    <h3 class="text-lg font-semibold text-gray-900 dark:text-white">
                      Search Food
                    </h3>
                    <button type="button"
                      class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm h-8 w-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white"
                      data-modal-toggle="timeline-modal">
                      <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none"
                        viewBox="0 0 14 14">
                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                          d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6" />
                      </svg>
                      <span class="sr-only">Close modal</span>
                    </button>
                  </div>
                  <!-- open find food body -->
                  <div>
                    <div class="p-4 md:p-5">
                      <form id="food-search-form" class="max-w-md mx-auto mb-6 flex items-center space-x-2">
                        <label for="food-search-input" class="sr-only">Search Food</label>
                        <input type="text" id="food-search-input" name="query" placeholder="Search for food..."
                          class="flex-grow p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white"
                          autocomplete="off" />
                        <button type="submit"
                          class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">
                          Search
                        </button>
                      </form>
                      <div id="food-search-results"
                        class="max-w-md mx-auto mb-6 max-h-60 overflow-y-auto border border-gray-300 rounded-md dark:border-gray-600">
                        <!-- Search results will be appended here -->
                      </div>
                      <h4 class="text-lg font-semibold mb-4 dark:text-white">
                        Selected Food Items
                      </h4>
                      <ul id="selected-food-list"
                        class="max-w-md mx-auto divide-y divide-gray-200 dark:divide-gray-700 mb-6 max-h-48 overflow-y-auto">
                        <!-- Selected food items will be appended here -->
                      </ul>
                      <div class="text-right max-w-md mx-auto mb-4">
                        <span class="font-semibold dark:text-white">Total Nutrition Score: </span>
                        <span id="total-calories" class="font-bold dark:text-white">0</span>
                      </div>
                      <button id="confirm-food-selection"
                        class="text-white w-full bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800">
                        Yes I've Eaten Today
                      </button>
                    </div>
                  </div>
                  <!-- open find body ends here -->

                  <script>
                    document.addEventListener("DOMContentLoaded", function () {
                      const searchInput = document.getElementById("food-search-input");
                      const searchResultsContainer = document.getElementById("food-search-results");
                      const selectedFoodList = document.getElementById("selected-food-list");
                      const totalCaloriesSpan = document.getElementById("total-calories");
                      const confirmButton = document.getElementById("confirm-food-selection");
                      const resetButton = document.getElementById("resetFoodButton");

                      let selectedFoods = [];

                      // Helper to get unit (g, ml, pieces) based on food object
                      function getFoodUnit(food) {
                        if (food.unit) return food.unit;
                        const desc = (food.description || "").toLowerCase();

                        // Handle liquids
                        if (desc.includes("ml") || desc.includes("juice") ||
                          desc.includes("milk") || desc.includes("water") ||
                          desc.includes("drink") || desc.includes("beverage")) {
                          return "ml";
                        }

                        // Handle pieces
                        if (desc.includes("piece") || desc.includes("egg") ||
                          desc.includes("bread") || desc.includes("slice") ||
                          desc.includes("banana") || desc.includes("apple") ||
                          desc.includes("mango")) {
                          return "pieces";
                        }

                        // Default to grams for solid foods
                        return "g";
                      }

                      // Render search results, only unique food names, show best match
                      function renderSearchResults(foods) {
                        searchResultsContainer.innerHTML = "";
                        if (!foods || foods.length === 0) {
                          searchResultsContainer.innerHTML =
                            '<p class="p-2 text-gray-500 dark:text-gray-400">No results found.</p>';
                          return;
                        }

                        // Map to unique food names, pick the first (best) match for each name
                        const uniqueFoods = {};
                        foods.forEach(food => {
                          const key = (food.description || "").toLowerCase().trim();
                          if (!uniqueFoods[key]) {
                            uniqueFoods[key] = food;
                          }
                        });

                        // Filter by search keyword in name (case-insensitive)
                        const keyword = searchInput.value.trim().toLowerCase();
                        const filtered = Object.values(uniqueFoods).filter(food =>
                          (food.description || "").toLowerCase().includes(keyword)
                        );

                        filtered.slice(0, 6).forEach((food) => {
                          const item = document.createElement("div");
                          item.className =
                            "p-2 cursor-pointer hover:bg-gray-200 dark:hover:bg-gray-600 flex justify-between items-center";
                          item.textContent =
                            food.description +
                            " (" +
                            (food.calories ? food.calories.toFixed(2) : "0") +
                            " cal, " +
                            getFoodUnit(food) +
                            ")";
                          item.addEventListener("click", () => {
                            addFoodItem(food);
                            clearSearchResults();
                          });
                          searchResultsContainer.appendChild(item);
                        });
                      }

                      function clearSearchResults() {
                        searchResultsContainer.innerHTML = "";
                        searchInput.value = "";
                      }

                      function renderSelectedFoods() {
                        selectedFoodList.innerHTML = "";
                        selectedFoods.forEach((food, index) => {
                          const li = document.createElement("li");
                          li.className = "flex justify-between items-center py-2 px-4 dark:text-white";

                          const descriptionSpan = document.createElement("span");
                          descriptionSpan.textContent =
                            food.description;

                          // Quantity controls container
                          const quantityContainer = document.createElement("div");
                          quantityContainer.className = "flex items-center";

                          // Minus button
                          const minusBtn = document.createElement("button");
                          minusBtn.textContent = "-";
                          minusBtn.className =
                            "px-2 py-1 bg-gray-200 dark:bg-gray-600 rounded-l hover:bg-gray-300 dark:hover:bg-gray-500";
                          minusBtn.addEventListener("click", () => {
                            if ((selectedFoods[index].quantity || 1) > (getFoodUnit(food) === "pieces" ? 1 : 0)) {
                              selectedFoods[index].quantity -= getFoodUnit(food) === "pieces" ? 1 : 10;
                              renderSelectedFoods();
                              updateTotalNutritionScore();
                            }
                          });

                          // Plus button
                          const plusBtn = document.createElement("button");
                          plusBtn.textContent = "+";
                          plusBtn.className =
                            "px-2 py-1 bg-gray-200 dark:bg-gray-600 rounded-r hover:bg-gray-300 dark:hover:bg-gray-500";
                          plusBtn.addEventListener("click", () => {
                            selectedFoods[index].quantity += getFoodUnit(food) === "pieces" ? 1 : 10;
                            renderSelectedFoods();
                            updateTotalNutritionScore();
                          });

                          // Add controls to container
                          quantityContainer.appendChild(minusBtn);
                          quantityContainer.appendChild(quantityInput);
                          quantityContainer.appendChild(plusBtn);

                          // Add unit span after input
                          const unitSpan = document.createElement("span");
                          unitSpan.className = "ml-1 text-gray-500 dark:text-gray-400";
                          unitSpan.textContent = getFoodUnit(food);

                          const removeBtn = document.createElement("button");
                          removeBtn.className =
                            "ml-4 text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-600";
                          removeBtn.textContent = "Remove";
                          removeBtn.addEventListener("click", () => {
                            removeFoodItem(index);
                          });

                          li.appendChild(descriptionSpan);
                          li.appendChild(quantityContainer);
                          li.appendChild(unitSpan);
                          li.appendChild(removeBtn);
                          selectedFoodList.appendChild(li);
                        });
                        updateTotalNutritionScore();
                      }

                      // When adding a food, set quantity based on unit
                      function addFoodItem(food) {
                        if (!selectedFoods.some((f) => f.fdcId === food.fdcId)) {
                          const unit = getFoodUnit(food);
                          let quantity = unit === "pieces" ? 1 : 100; // Default to 1 piece or 100g/ml
                          food.quantity = quantity;
                          selectedFoods.push(food);
                          renderSelectedFoods();
                        }
                      }

                      function removeFoodItem(index) {
                        selectedFoods.splice(index, 1);
                        renderSelectedFoods();
                      }

                      async function updateTotalNutritionScore() {
                        if (selectedFoods.length === 0) {
                          document.getElementById('total-calories').textContent = "0";
                          document.getElementById('nutrition-score-value').textContent = "0";
                          const circle = document.getElementById('nutrition-score-progress');
                          if (circle) {
                            circle.style.strokeDashoffset = 283;
                          }
                          resetButton.disabled = true;
                          return;
                        }

                        // Show loading spinner while fetching
                        document.getElementById('total-calories').innerHTML = '<span class="loader inline-block w-4 h-4 border-2 border-t-2 border-gray-200 rounded-full animate-spin"></span>';

                        // Prepare payload for backend
                        const payload = selectedFoods.map(food => ({
                          fdcId: food.fdcId,
                          description: food.description,
                          quantity: Number(food.quantity) || 0,
                          calories: Number(food.calories) || 0,
                          protein: Number(food.protein) || 0,
                          fiber: Number(food.fiber) || 0,
                          vitamins: Number(food.vitamins) || 0,
                          sugar: Number(food.sugar) || 0,
                          saturatedFat: Number(food.saturatedFat) || 0,
                          sodium: Number(food.sodium) || 0,
                          minerals: typeof food.minerals !== 'undefined' ? Number(food.minerals) : 0,
                          transFat: typeof food.transFat !== 'undefined' ? Boolean(food.transFat) : false
                        }));

                        try {
                          console.log("Sending payload to /user/food/save:", payload);
                          const response = await fetch('/user/food/save', {
                            method: 'POST',
                            headers: {
                              'Content-Type': 'application/json',
                              'X-CSRF-TOKEN': (document.querySelector('meta[name="_csrf"]') ? document.querySelector('meta[name="_csrf"]').getAttribute('content') : '')
                            },
                            credentials: 'include',
                            body: JSON.stringify(payload)
                          });

                          if (!response.ok) {
                            const errorText = await response.text();
                            throw new Error('Failed to calculate nutrition score: ' + errorText);
                          }

                          const data = await response.json();
                          const nutritionScore = data.nutritionScore || 0;

                          // Update UI with nutrition score
                          document.getElementById('total-calories').textContent = nutritionScore;
                          document.getElementById('nutrition-score-value').textContent = nutritionScore;

                          // Update the circle progress
                          const circle = document.getElementById('nutrition-score-progress');
                          if (circle) {
                            const circumference = 283;
                            const offset = circumference - (nutritionScore / 10) * circumference;
                            circle.style.strokeDashoffset = offset;
                          }

                          // Enable reset button
                          resetButton.disabled = false;
                        } catch (error) {
                          console.error("Error fetching nutrition score:", error);
                          document.getElementById('total-calories').textContent = "Error: " + error.message;
                        }
                      }

                      async function searchFoods(query) {
                        if (!query || query.trim().length === 0) {
                          renderSearchResults([]);
                          return;
                        }
                        try {
                          const response = await fetch(
                            `/user/food/search?query=${encodeURIComponent(query)}`,
                            {
                              credentials: "include",
                            },
                          );
                          if (!response.ok) {
                            throw new Error("Failed to fetch food search results");
                          }
                          const data = await response.json();
                          renderSearchResults(data);
                        } catch (error) {
                          console.error("Error searching foods:", error);
                          renderSearchResults([]);
                        }
                      }

                      // Reset functionality
                      resetButton.addEventListener("click", () => {
                        selectedFoods = [];
                        renderSelectedFoods();
                      });

                      let debounceTimeout = null;
                      searchInput.addEventListener("input", () => {
                        clearTimeout(debounceTimeout);
                        debounceTimeout = setTimeout(() => {
                          searchFoods(searchInput.value);
                        }, 300);
                      });

                      document.getElementById("food-search-form").addEventListener("submit", (e) => {
                        e.preventDefault();
                        searchFoods(searchInput.value);
                      });

                      confirmButton.addEventListener("click", async () => {
                        if (selectedFoods.length === 0) {
                          alert("Please select at least one food item.");
                          return;
                        }
                        try {
                          // Call backend to save food entries and get updated nutrition score
                          const payload = selectedFoods.map(food => ({
                            fdcId: food.fdcId,
                            description: food.description,
                            quantity: food.quantity,
                            calories: food.calories,
                            protein: food.protein || 0,
                            fiber: food.fiber || 0,
                            vitamins: food.vitamins || 0,
                            sugar: food.sugar || 0,
                            saturatedFat: food.saturatedFat || 0,
                            sodium: food.sodium || 0,
                            minerals: food.minerals || 0,
                            transFat: food.transFat || false
                          }));

                          const response = await fetch('/user/food/save', {
                            method: 'POST',
                            headers: {
                              'Content-Type': 'application/json',
                              'X-CSRF-TOKEN': document.querySelector('meta[name="_csrf"]').getAttribute('content')
                            },
                            credentials: 'include',
                            body: JSON.stringify(payload)
                          });

                          if (!response.ok) {
                            throw new Error('Failed to save food entries');
                          }

                          const data = await response.json();
                          const updatedScore = data.nutritionScore || 0;

                          // Update main dashboard nutrition score UI
                          updateNutritionScoreUI(updatedScore);

                          // Close modal
                          const modal = document.getElementById("timeline-modal");
                          if (modal) {
                            modal.classList.add("hidden");
                          }

                          // Reset selected foods and UI
                          selectedFoods = [];
                          renderSelectedFoods();

                        } catch (error) {
                          console.error("Error saving food entries:", error);
                          alert("Failed to save food entries. Please try again.");
                        }
                      });

                      // Hide search results when clicking outside
                      document.addEventListener("click", (event) => {
                        const isClickInside =
                          document.getElementById("food-search-form").contains(event.target) ||
                          document.getElementById("food-search-results").contains(event.target);
                        if (!isClickInside) {
                          searchResultsContainer.innerHTML = "";
                        }
                      });
                    });

                    // Add CSS for loader spinner
                    const style = document.createElement('style');
                    style.innerHTML = `
                      .loader {
                        border-top-color: #3498db;
                        -webkit-animation: spin 1s linear infinite;
                        animation: spin 1s linear infinite;
                      }
                      @-webkit-keyframes spin {
                        0% { -webkit-transform: rotate(0deg); }
                        100% { transform: rotate(0deg); }
                      }
                      @keyframes spin {
                        0% { transform: rotate(0deg); }
                        100% { transform: rotate(360deg); }
                      }
                    `;
                    document.head.appendChild(style);
                  </script>
                </div>
              </div>
            </div>
            <!-- nutrition score ends here  -->
          </div>
          <!-- Add more health  bich ka metrics here -->

          <!-- Meditation tracking starts here -->
          <div class="text-center">
            <div class="relative w-24 h-24 mx-auto">
              <svg class="w-full h-full transform -rotate-90">
                <circle cx="50%" cy="50%" r="45%" fill="none" stroke-width="8" stroke="#e0e0e0"></circle>
                <circle id="progressCircle" cx="50%" cy="50%" r="45%" fill="none" stroke-width="8" stroke="#7be5ff"
                  stroke-dasharray="283" stroke-dashoffset="283" style="transition: stroke-dashoffset 1s linear">
                </circle>
              </svg>
</html>
